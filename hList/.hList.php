<?php
  class hList extends hPlugin { public function getListId($listName) { return (int) $this->hLists->selectColumn( 'hListId', array( 'hListName' => $listName ) ); } public function getListName($listId) { return $this->hLists->selectColumn('hListName', (int) $listId); } public function listHasFiles($listName, $fileId = 0) { return $this->hListFiles->selectExists( 'hListFileId', array( 'hFileId' => (empty($fileId)? (int) $this->hFileId : (int) $fileId), 'hListId' => $this->getListId($listName) ) ); } public function getListFiles($listName, $fileId = 0) { return $this->hListFiles->select( 'hListFileId', array( 'hFileId' => (empty($fileId)? (int) $this->hFileId : (int) $fileId), 'hListId' => $this->getListId($listName) ), 'AND', 'hListFileSortIndex' ); } public function getList($listId, $getIcons = true, $getHTMLIcon = false) { $iconResolution = $this->hFileIconResolution('32x32'); $this->hFileIconResolution = '16x16'; $html = ''; (int) $fileId = $this->hFileSymbolicLinkTo($this->hFileId); $listFiles = $this->hDatabase->selectForTemplate( array( 'hFilePath', 'hListFiles' => array( 'hFileId', 'hListFileId' ), 'hFileDocuments' => 'hFileTitle', 'hFiles' => 'hFileName' ), array( 'hListFiles', 'hFileDocuments', 'hFiles' ), array( 'hListFiles.hFileId' => (int) $fileId, 'hListFiles.hListId' => (int) $listId, 'hListFiles.hListFileId' => array( array('=', 'hFileDocuments.hFileId'), array('=', 'hFiles.hFileId') ) ), 'AND', 'hListFileSortIndex' ); $this->hFileIconResolution = $iconResolution; $html = $this->getTemplate( 'List Files', array( 'hListFiles' => $listFiles, 'prefix' => $this->hListClassIdPrefix('') ) ); $listName = $this->getListName($listId); return $this->getListTemplate($html, $listName, strtolower(str_replace(' ', '', $listName))); } public function getListTemplate($listFiles, $listName = null, $id = null, $ul = true) { return $this->getTemplate( 'List Template', array( 'hListUL' => $ul, 'hListId' => $id, 'hListName' => $listName, 'hListFiles' => $listFiles, 'prefix' => $this->hListClassIdPrefix('') ) ); } } ?>